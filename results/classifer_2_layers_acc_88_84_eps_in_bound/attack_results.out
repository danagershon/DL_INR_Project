*** SLURM BATCH JOB 'test_job' STARTING ***
*** Activating environment inrs ***
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:08,  1.13it/s]  9%|▉         | 7/79 [00:00<00:07,  9.21it/s] 16%|█▋        | 13/79 [00:01<00:03, 17.33it/s] 24%|██▍       | 19/79 [00:01<00:02, 24.98it/s] 32%|███▏      | 25/79 [00:01<00:01, 31.82it/s] 39%|███▉      | 31/79 [00:01<00:01, 37.60it/s] 47%|████▋     | 37/79 [00:01<00:00, 42.28it/s] 54%|█████▍    | 43/79 [00:01<00:00, 45.97it/s] 62%|██████▏   | 49/79 [00:01<00:00, 48.74it/s] 70%|██████▉   | 55/79 [00:01<00:00, 50.79it/s] 77%|███████▋  | 61/79 [00:01<00:00, 52.17it/s] 85%|████████▍ | 67/79 [00:02<00:00, 53.28it/s] 92%|█████████▏| 73/79 [00:02<00:00, 54.06it/s]                                               Test accuracy after attack with linf_bound=1e-06: 88.84%
  0%|          | 0/79 [00:00<?, ?it/s]  4%|▍         | 3/79 [00:00<00:02, 26.25it/s] 11%|█▏        | 9/79 [00:00<00:01, 43.24it/s] 19%|█▉        | 15/79 [00:00<00:01, 48.85it/s] 27%|██▋       | 21/79 [00:00<00:01, 51.77it/s] 34%|███▍      | 27/79 [00:00<00:00, 53.26it/s] 42%|████▏     | 33/79 [00:00<00:00, 54.05it/s] 49%|████▉     | 39/79 [00:00<00:00, 54.41it/s] 57%|█████▋    | 45/79 [00:00<00:00, 54.51it/s] 65%|██████▍   | 51/79 [00:00<00:00, 54.87it/s] 72%|███████▏  | 57/79 [00:01<00:00, 55.33it/s] 80%|███████▉  | 63/79 [00:01<00:00, 55.67it/s] 87%|████████▋ | 69/79 [00:01<00:00, 55.44it/s] 95%|█████████▍| 75/79 [00:01<00:00, 55.76it/s]                                               Test accuracy after attack with linf_bound=4.9999999999999996e-06: 87.70%
  0%|          | 0/79 [00:00<?, ?it/s]  4%|▍         | 3/79 [00:00<00:02, 25.41it/s] 11%|█▏        | 9/79 [00:00<00:01, 41.65it/s] 19%|█▉        | 15/79 [00:00<00:01, 47.76it/s] 27%|██▋       | 21/79 [00:00<00:01, 50.82it/s] 34%|███▍      | 27/79 [00:00<00:00, 52.59it/s] 42%|████▏     | 33/79 [00:00<00:00, 53.63it/s] 49%|████▉     | 39/79 [00:00<00:00, 54.24it/s] 57%|█████▋    | 45/79 [00:00<00:00, 54.30it/s] 65%|██████▍   | 51/79 [00:00<00:00, 54.39it/s] 72%|███████▏  | 57/79 [00:01<00:00, 54.59it/s] 80%|███████▉  | 63/79 [00:01<00:00, 54.64it/s] 87%|████████▋ | 69/79 [00:01<00:00, 54.89it/s] 95%|█████████▍| 75/79 [00:01<00:00, 55.54it/s]                                               Test accuracy after attack with linf_bound=1e-05: 86.14%
  0%|          | 0/79 [00:00<?, ?it/s]  4%|▍         | 3/79 [00:00<00:02, 25.68it/s] 11%|█▏        | 9/79 [00:00<00:01, 42.87it/s] 19%|█▉        | 15/79 [00:00<00:01, 48.60it/s] 27%|██▋       | 21/79 [00:00<00:01, 51.45it/s] 34%|███▍      | 27/79 [00:00<00:00, 53.05it/s] 42%|████▏     | 33/79 [00:00<00:00, 53.99it/s] 49%|████▉     | 39/79 [00:00<00:00, 54.65it/s] 57%|█████▋    | 45/79 [00:00<00:00, 54.65it/s] 65%|██████▍   | 51/79 [00:00<00:00, 54.96it/s] 72%|███████▏  | 57/79 [00:01<00:00, 54.94it/s] 80%|███████▉  | 63/79 [00:01<00:00, 54.99it/s] 87%|████████▋ | 69/79 [00:01<00:00, 54.94it/s] 95%|█████████▍| 75/79 [00:01<00:00, 55.35it/s]                                               Test accuracy after attack with linf_bound=5e-05: 70.08%
  0%|          | 0/79 [00:00<?, ?it/s]  3%|▎         | 2/79 [00:00<00:03, 19.83it/s] 10%|█         | 8/79 [00:00<00:01, 40.91it/s] 18%|█▊        | 14/79 [00:00<00:01, 47.19it/s] 25%|██▌       | 20/79 [00:00<00:01, 50.18it/s] 33%|███▎      | 26/79 [00:00<00:01, 52.02it/s] 41%|████      | 32/79 [00:00<00:00, 53.01it/s] 48%|████▊     | 38/79 [00:00<00:00, 54.23it/s] 56%|█████▌    | 44/79 [00:00<00:00, 55.11it/s] 63%|██████▎   | 50/79 [00:00<00:00, 56.19it/s] 71%|███████   | 56/79 [00:01<00:00, 56.83it/s] 78%|███████▊  | 62/79 [00:01<00:00, 57.37it/s] 86%|████████▌ | 68/79 [00:01<00:00, 57.60it/s] 94%|█████████▎| 74/79 [00:01<00:00, 57.42it/s]                                               Test accuracy after attack with linf_bound=0.0001: 47.29%
  0%|          | 0/79 [00:00<?, ?it/s]  4%|▍         | 3/79 [00:00<00:02, 27.87it/s] 11%|█▏        | 9/79 [00:00<00:01, 45.61it/s] 19%|█▉        | 15/79 [00:00<00:01, 51.37it/s] 27%|██▋       | 21/79 [00:00<00:01, 53.96it/s] 34%|███▍      | 27/79 [00:00<00:00, 55.27it/s] 42%|████▏     | 33/79 [00:00<00:00, 55.84it/s] 49%|████▉     | 39/79 [00:00<00:00, 56.64it/s] 57%|█████▋    | 45/79 [00:00<00:00, 57.27it/s] 65%|██████▍   | 51/79 [00:00<00:00, 57.62it/s] 72%|███████▏  | 57/79 [00:01<00:00, 57.89it/s] 80%|███████▉  | 63/79 [00:01<00:00, 58.07it/s] 87%|████████▋ | 69/79 [00:01<00:00, 58.28it/s] 95%|█████████▍| 75/79 [00:01<00:00, 58.73it/s]                                               Test accuracy after attack with linf_bound=0.0005: 0.55%
  0%|          | 0/79 [00:00<?, ?it/s]  4%|▍         | 3/79 [00:00<00:02, 27.47it/s] 11%|█▏        | 9/79 [00:00<00:01, 45.46it/s] 19%|█▉        | 15/79 [00:00<00:01, 51.28it/s] 27%|██▋       | 21/79 [00:00<00:01, 54.27it/s] 34%|███▍      | 27/79 [00:00<00:00, 55.81it/s] 42%|████▏     | 33/79 [00:00<00:00, 56.81it/s] 49%|████▉     | 39/79 [00:00<00:00, 57.35it/s] 57%|█████▋    | 45/79 [00:00<00:00, 57.77it/s] 65%|██████▍   | 51/79 [00:00<00:00, 58.02it/s] 72%|███████▏  | 57/79 [00:01<00:00, 58.18it/s] 80%|███████▉  | 63/79 [00:01<00:00, 58.07it/s] 87%|████████▋ | 69/79 [00:01<00:00, 58.11it/s] 96%|█████████▌| 76/79 [00:01<00:00, 59.30it/s]                                               Test accuracy after attack with linf_bound=0.001: 0.49%
  0%|          | 0/79 [00:00<?, ?it/s]  4%|▍         | 3/79 [00:00<00:02, 27.82it/s] 11%|█▏        | 9/79 [00:00<00:01, 44.94it/s] 19%|█▉        | 15/79 [00:00<00:01, 50.98it/s] 27%|██▋       | 21/79 [00:00<00:01, 54.00it/s] 34%|███▍      | 27/79 [00:00<00:00, 55.66it/s] 42%|████▏     | 33/79 [00:00<00:00, 56.68it/s] 49%|████▉     | 39/79 [00:00<00:00, 57.32it/s] 57%|█████▋    | 45/79 [00:00<00:00, 57.73it/s] 65%|██████▍   | 51/79 [00:00<00:00, 58.01it/s] 72%|███████▏  | 57/79 [00:01<00:00, 58.34it/s] 80%|███████▉  | 63/79 [00:01<00:00, 58.43it/s] 87%|████████▋ | 69/79 [00:01<00:00, 58.48it/s] 96%|█████████▌| 76/79 [00:01<00:00, 59.55it/s]                                               Test accuracy after attack with linf_bound=0.005: 0.49%
Plot saved to attack_accuracy_plot.png
  0%|          | 0/79 [00:00<?, ?it/s]  3%|▎         | 2/79 [00:00<00:03, 19.94it/s] 10%|█         | 8/79 [00:00<00:01, 42.03it/s] 18%|█▊        | 14/79 [00:00<00:01, 49.13it/s] 25%|██▌       | 20/79 [00:00<00:01, 52.18it/s] 33%|███▎      | 26/79 [00:00<00:00, 53.94it/s] 41%|████      | 32/79 [00:00<00:00, 54.13it/s] 48%|████▊     | 38/79 [00:00<00:00, 54.84it/s] 56%|█████▌    | 44/79 [00:00<00:00, 55.57it/s] 63%|██████▎   | 50/79 [00:00<00:00, 55.94it/s] 71%|███████   | 56/79 [00:01<00:00, 56.29it/s] 78%|███████▊  | 62/79 [00:01<00:00, 56.55it/s] 86%|████████▌ | 68/79 [00:01<00:00, 56.78it/s] 94%|█████████▎| 74/79 [00:01<00:00, 56.89it/s]                                               /home/dana.gershon/miniconda3/envs/inrs/lib/python3.10/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3483.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/dana.gershon/project/DL_INR_Project/evaluation_questions.py:102: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  clean_vec = torch.tensor(clean_vectors[i]).to(device)
Confusion matrix for Adversarial Test (epsilon=5e-05) set saved as Adversarial_Test_(epsilon=5e-05)_confusion_matrix.png
Visualization saved to class_attack_visualization.png
*** SLURM BATCH JOB 'test_job' DONE ***
